#!/usr/bin/python3

import numpy as np

#by reversing
enc_flag_li = \
[[101607,  64693, 108504,  66997,  70993],
 [115942, 115270,  82702,  74378,  59728],
 [ 59188, 102446,  96720,  80703,  95089],
 [ 98601,  58826,  59426, 102259,  53330],
 [ 89909, 103118, 102655,  66767,  64083]]

#also by reversing
key_li = \
[[119, 101,  95, 119, 105],
 [108, 108,  95, 109, 105],
 [115, 115,  95, 121, 111],
 [117,  95, 112, 114, 111],
 [ 99, 102, 115,  46,  46]]

#even this by reversing
const_li = \
[[41546,  8619, 53491, 12367, 19810],
 [56577, 60086, 27970, 20573,  9151],
 [ 3554, 50732, 45063, 30800, 48142],
 [44842,  8366, 10332, 53130,  7242],
 [28114, 45541, 46379,  9801, 10691]]

enc_flag_mat = np.array(enc_flag_li)
key_mat = np.array(key_li)
const_mat = np.array(const_li)

enc_flag_mat = np.subtract(enc_flag_mat, const_mat)
print(enc_flag_mat)
flag_mat = np.matmul(enc_flag_mat, np.linalg.inv(key_mat))
print(flag_mat)

print("CODEGATE2020{", end="")
for i in range(5):
    for j in range(5):
        print(chr(round(flag_mat[i][j])), end="")
print("}")
